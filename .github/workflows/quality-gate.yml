name: CI - Engenharia de Software II (UFS)

# Gatilhos: O pipeline corre sempre que houver um Push ou Pull Request
on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]

jobs:
  quality-check:
    name: Analise de Qualidade Rust
    runs-on: ubuntu-latest # Usa uma máquina virtual Linux gratuita

    steps:
      # 1. Descarrega o código do repositório para a máquina virtual
      - name: Checkout do repositorio
        uses: actions/checkout@v4

      # 2. Configura o ambiente Rust (necessário para o Screenpipe)
      - name: Instalar Rust Toolchain
        uses: dtolnay/rust-toolchain@stable
        with:
          components: clippy, rustfmt

      # 3. Executa o Rustfmt: Verifica se o código respeita as regras de estilo
      - name: Verificar formatacao (Rustfmt)
        run: cargo fmt --all -- --check

      # 4. Executa o Clippy: Procura erros de lógica, bugs comuns e "bad smells"
      # O parâmetro -D warnings faz o pipeline falhar se houver qualquer aviso
      - name: Analise estatica (Clippy)
        run: cargo clippy -- -D warnings
